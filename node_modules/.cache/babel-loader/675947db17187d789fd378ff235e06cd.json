{"ast":null,"code":"import _objectSpread from \"/Users/jenniferpierce/Code/closet app/closetchart/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _toConsumableArray from \"/Users/jenniferpierce/Code/closet app/closetchart/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"/Users/jenniferpierce/Code/closet app/closetchart/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/jenniferpierce/Code/closet app/closetchart/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/jenniferpierce/Code/closet app/closetchart/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/jenniferpierce/Code/closet app/closetchart/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/jenniferpierce/Code/closet app/closetchart/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/jenniferpierce/Code/closet app/closetchart/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/Users/jenniferpierce/Code/closet app/closetchart/src/pages/capsule/editor/CapsuleEditor.js\";\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport { compose } from 'redux';\nimport { firestoreConnect } from 'react-redux-firebase';\nimport { Button } from 'react-bootstrap';\nimport { Redirect } from 'react-router-dom';\nimport queryString from 'query-string';\nimport CapsuleAccordion from './CapsuleAccordion';\nimport CapsuleEditorClosetGarment from './CapsuleEditorClosetGarment';\nimport Closet from 'pages/closet/Closet';\nimport OutfitEditor from './OutfitEditor';\nimport styles from '../capsule.module.css';\nexport var CapsuleEditor =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(CapsuleEditor, _React$Component);\n\n  function CapsuleEditor() {\n    var _this;\n\n    _classCallCheck(this, CapsuleEditor);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(CapsuleEditor).call(this));\n    _this.state = {\n      outfitGarmentIDs: []\n    };\n    _this.addGarmentToOutfit = _this.addGarmentToOutfit.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.deleteOutfitFromGarment = _this.deleteOutfitFromGarment.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.saveOutfit = _this.saveOutfit.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(CapsuleEditor, [{\n    key: \"addGarmentToOutfit\",\n    value: function addGarmentToOutfit(id) {\n      if (!this.state.outfitGarmentIDs.includes(id)) {\n        this.setState({\n          outfitGarmentIDs: _toConsumableArray(this.state.outfitGarmentIDs).concat([id])\n        });\n      } else {\n        // TODO: Convert to nicer modal message.\n        alert('That garment is already in this outfit.');\n      }\n    }\n  }, {\n    key: \"deleteOutfitFromGarment\",\n    value: function deleteOutfitFromGarment(idToDelete) {\n      this.setState({\n        outfitGarmentIDs: this.state.outfitGarmentIDs.filter(function (id) {\n          return id !== idToDelete;\n        })\n      });\n    }\n  }, {\n    key: \"saveOutfit\",\n    value: function saveOutfit() {\n      var query = queryString.parse(this.props.location.search);\n\n      if (query.outfit === 'new') {\n        this.props.firestore.add({\n          collection: 'outfits'\n        }, {\n          capsuleID: this.props.match.params.id,\n          garments: this.state.outfitGarmentIDs,\n          userID: this.props.uid\n        });\n      } else {\n        return this.props.firestore.set({\n          collection: 'outfits',\n          doc: query.outfit\n        }, {\n          garments: this.state.outfitGarmentIDs\n        }, {\n          merge: true\n        }).then(function () {\n          console.log(\"Document successfully written!\");\n        }).catch(function (error) {\n          console.error(\"Error writing document: \", error);\n        });\n      }\n    }\n  }, {\n    key: \"loadInitialGarments\",\n    value: function loadInitialGarments() {\n      // If user is editing an existing outfit, load garments into initial state.\n      var query = queryString.parse(this.props.location.search);\n\n      if (query.outfit !== 'new' && query.outfit !== undefined) {\n        if (this.props.outfits !== null) {\n          var outfit = this.props.outfits[query.outfit];\n          this.setState({\n            outfitGarmentIDs: outfit.garments\n          });\n        }\n      }\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.loadInitialGarments();\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      if (this.props !== prevProps) {\n        this.loadInitialGarments();\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var capsuleGarments = [];\n      var capsuleAccordion;\n\n      if (this.props.capsule !== null && this.props.garments !== null && this.props.images !== null) {\n        capsuleGarments = this.props.capsule.garments.map(function (gID) {\n          var garment = _objectSpread({}, _this2.props.garments[gID], {\n            id: gID\n          });\n\n          var image = _this2.props.images[garment.imageID];\n          return {\n            garment: garment,\n            image: image\n          };\n        });\n        capsuleAccordion = React.createElement(CapsuleAccordion, {\n          capsuleID: this.props.capsule.id,\n          garments: capsuleGarments,\n          handleAdd: this.addGarmentToOutfit,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 107\n          },\n          __self: this\n        });\n      } // TODO: In the closet, add an overlay to garments that are already\n      // in the capsule (and prevent add).\n\n\n      return React.createElement(\"div\", {\n        className: styles.editor,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: styles.closet,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117\n        },\n        __self: this\n      }, React.createElement(Closet, {\n        render: function render(garment, image) {\n          return React.createElement(CapsuleEditorClosetGarment, {\n            key: garment.id,\n            garment: garment,\n            image: image,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 120\n            },\n            __self: this\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"col-md-4 col-lg-4\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123\n        },\n        __self: this\n      }, React.createElement(\"h3\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124\n        },\n        __self: this\n      }, \"Capsule\"), capsuleAccordion), React.createElement(\"div\", {\n        className: \"col-md-8 col-lg-8\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127\n        },\n        __self: this\n      }, React.createElement(\"h3\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      }, \"Outfit Editor\"), React.createElement(\"div\", {\n        className: \"col-md-12 col-lg-12\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129\n        },\n        __self: this\n      }, React.createElement(OutfitEditor, {\n        garmentIDs: this.state.outfitGarmentIDs,\n        handleDelete: this.deleteOutfitFromGarment,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130\n        },\n        __self: this\n      })), React.createElement(Button, {\n        onClick: this.saveOutfit,\n        disabled: !this.state.outfitGarmentIDs.length,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134\n        },\n        __self: this\n      }, \"Save Outfit\")));\n    }\n  }]);\n\n  return CapsuleEditor;\n}(React.Component);\nCapsuleEditor.propTypes = {};\n\nvar mapStateToProps = function mapStateToProps(state, ownProps) {\n  return {\n    uid: state.firebase.auth.uid,\n    capsule: state.firestore.data.capsules ? state.firestore.data.capsules[ownProps.match.params.id] : null,\n    garments: state.firestore.data.garments ? state.firestore.data.garments : null,\n    images: state.firestore.data.images ? state.firestore.data.images : null,\n    outfits: state.firestore.data.outfits ? state.firestore.data.outfits : null\n  };\n};\n\nexport default compose(connect(mapStateToProps, null), firestoreConnect())(CapsuleEditor);","map":{"version":3,"sources":["/Users/jenniferpierce/Code/closet app/closetchart/src/pages/capsule/editor/CapsuleEditor.js"],"names":["React","PropTypes","connect","compose","firestoreConnect","Button","Redirect","queryString","CapsuleAccordion","CapsuleEditorClosetGarment","Closet","OutfitEditor","styles","CapsuleEditor","state","outfitGarmentIDs","addGarmentToOutfit","bind","deleteOutfitFromGarment","saveOutfit","id","includes","setState","alert","idToDelete","filter","query","parse","props","location","search","outfit","firestore","add","collection","capsuleID","match","params","garments","userID","uid","set","doc","merge","then","console","log","catch","error","undefined","outfits","loadInitialGarments","prevProps","capsuleGarments","capsuleAccordion","capsule","images","map","gID","garment","image","imageID","editor","closet","length","Component","propTypes","mapStateToProps","ownProps","firebase","auth","data","capsules"],"mappings":"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","sourcesContent":["import React from 'react'\nimport PropTypes from 'prop-types'\nimport { connect } from 'react-redux'\nimport { compose } from 'redux'\nimport { firestoreConnect } from 'react-redux-firebase'\nimport { Button } from 'react-bootstrap'\nimport { Redirect } from 'react-router-dom'\nimport queryString from 'query-string'\n\nimport CapsuleAccordion from './CapsuleAccordion'\nimport CapsuleEditorClosetGarment from './CapsuleEditorClosetGarment'\nimport Closet from 'pages/closet/Closet'\nimport OutfitEditor from './OutfitEditor'\n\nimport styles from '../capsule.module.css'\n\nexport class CapsuleEditor extends React.Component {\n  static propTypes = {}\n\n  constructor () {\n    super ()\n    this.state = {\n      outfitGarmentIDs: []\n    }\n\n    this.addGarmentToOutfit = this.addGarmentToOutfit.bind(this)\n    this.deleteOutfitFromGarment = this.deleteOutfitFromGarment.bind(this)\n    this.saveOutfit = this.saveOutfit.bind(this)\n  }\n\n  addGarmentToOutfit (id) {\n    if (!this.state.outfitGarmentIDs.includes(id)){\n      this.setState({\n        outfitGarmentIDs: [ ...this.state.outfitGarmentIDs, id ]\n      })\n    } else {\n      // TODO: Convert to nicer modal message.\n      alert('That garment is already in this outfit.')\n    }\n  }\n\n  deleteOutfitFromGarment (idToDelete) {\n    this.setState({\n      outfitGarmentIDs: this.state.outfitGarmentIDs.filter(id => id !== idToDelete)\n    })\n  }\n\n  saveOutfit () {\n    const query = queryString.parse(this.props.location.search)\n    if (query.outfit === 'new'){\n      this.props.firestore.add(\n        { collection: 'outfits' },\n        {\n          capsuleID: this.props.match.params.id,\n          garments: this.state.outfitGarmentIDs,\n          userID: this.props.uid\n        }\n      )\n    } else {\n      return this.props.firestore.set(\n        { collection: 'outfits', doc: query.outfit },\n        { garments: this.state.outfitGarmentIDs },\n        { merge: true })\n      .then(function() {\n        console.log(\"Document successfully written!\");\n      })\n      .catch(function(error) {\n        console.error(\"Error writing document: \", error);\n      });\n    }\n  }\n\n  loadInitialGarments () {\n    // If user is editing an existing outfit, load garments into initial state.\n    const query = queryString.parse(this.props.location.search)\n    if (query.outfit !== 'new' && query.outfit !== undefined) {\n      if (this.props.outfits !== null) {\n        const outfit = this.props.outfits[query.outfit]\n        this.setState({ outfitGarmentIDs: outfit.garments })\n      }\n    }\n  }\n\n  componentDidMount () {\n    this.loadInitialGarments()\n  }\n\n  componentDidUpdate (prevProps) {\n    if (this.props !== prevProps) {\n      this.loadInitialGarments()\n    }\n  }\n\n  render () {\n    let capsuleGarments = []\n    let capsuleAccordion\n\n    if (this.props.capsule !== null &&\n      this.props.garments !== null &&\n      this.props.images !== null ) {\n      capsuleGarments = this.props.capsule.garments.map(gID => {\n        const garment = {...this.props.garments[gID], id: gID}\n        const image = this.props.images[garment.imageID]\n        return { garment, image }\n      })\n\n      capsuleAccordion = <CapsuleAccordion\n        capsuleID={this.props.capsule.id}\n        garments={capsuleGarments}\n        handleAdd={this.addGarmentToOutfit} />\n    }\n\n    // TODO: In the closet, add an overlay to garments that are already\n    // in the capsule (and prevent add).\n    return (\n      <div className={styles.editor}>\n        <div className={styles.closet}>\n          <Closet\n            render={(garment, image) => (\n              <CapsuleEditorClosetGarment key={garment.id} garment={garment} image={image} />\n            )} />\n        </div>\n        <div className='col-md-4 col-lg-4'>\n          <h3>Capsule</h3>\n          { capsuleAccordion }\n        </div>\n        <div className='col-md-8 col-lg-8'>\n          <h3>Outfit Editor</h3>\n          <div className='col-md-12 col-lg-12'>\n          <OutfitEditor\n            garmentIDs={this.state.outfitGarmentIDs}\n            handleDelete={this.deleteOutfitFromGarment} />\n            </div>\n          <Button\n            onClick={this.saveOutfit}\n            disabled={!this.state.outfitGarmentIDs.length}>\n            Save Outfit\n          </Button>\n        </div>\n      </div>\n    )\n  }\n}\n\nconst mapStateToProps = (state, ownProps) => ({\n  uid: state.firebase.auth.uid,\n  capsule: state.firestore.data.capsules ?\n    state.firestore.data.capsules[ownProps.match.params.id] :\n    null,\n  garments: state.firestore.data.garments ?\n    state.firestore.data.garments :\n    null,\n  images: state.firestore.data.images ?\n    state.firestore.data.images :\n    null,\n  outfits: state.firestore.data.outfits ?\n    state.firestore.data.outfits :\n    null\n})\n\nexport default compose(\n  connect(mapStateToProps, null),\n  firestoreConnect()\n)(CapsuleEditor)\n"]},"metadata":{},"sourceType":"module"}